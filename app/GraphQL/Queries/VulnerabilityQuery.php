<?php

namespace App\GraphQL\Queries;

use App\Vulnerability;
use Closure;
use App\User;
use Doctrine\DBAL\Types\BigIntType;
use Doctrine\DBAL\Types\DateTimeType;
use Doctrine\DBAL\Types\StringType;
use Illuminate\Support\Arr;
use Illuminate\Support\Facades\Auth;
use Illuminate\Support\Facades\Schema;
use Rebing\GraphQL\Support\Facades\GraphQL;
use GraphQL\Type\Definition\ResolveInfo;
use GraphQL\Type\Definition\Type;
use Rebing\GraphQL\Support\Query;

class VulnerabilityQuery extends GenericQuery
{

    public function authorize($root, array $args, $ctx, ResolveInfo $resolveInfo = null, Closure $getSelectFields = null): bool
    {
        // true, if logged in
        return ! Auth::guest();
    }

    protected $attributes = [
        'name' => 'vulnerabilities',
        'type' => 'Vulnerability',
        'class' => Vulnerability::class,
    ];

}
